// Generated by CoffeeScript 1.6.1

define(function() {
  var domCache, domExpandoAttr, nextId;
  nextId = 1;
  domCache = {};
  domExpandoAttr = "dom-" + (new Date().getTime());
  return {
    get: function(element, key) {
      var expandoId, expandoStore, noKey;
      noKey = key == null;
      if (expandoId = element[domExpandoAttr]) {
        expandoStore = domCache[expandoId];
      } else if (noKey) {
        domCache[element[domExpandoAttr] = nextId++] = expandoStore = {};
      }
      if (expandoStore) {
        if (noKey) {
          return expandoStore;
        } else {
          return expandoStore[key];
        }
      }
    },
    set: function(element, key, value) {
      var expandoId, result;
      if (expandoId = element[domExpandoAttr]) {
        domCache[expandoId][key] = value;
      } else {
        domCache[element[domExpandoAttr] = nextId++] = result = {};
        result[key] = value;
      }
    },
    remove: function(element, key) {
      var expandoId, expandoStore;
      if ((expandoId = element[domExpandoAttr]) && (expandoStore = domCache[expandoId])) {
        if (key != null) {
          delete expandoStore[key];
        } else {
          if (expandoStore.handle && expandoStore.handle.destroy) {
            expandoStore.handle.destroy();
          }
          delete domCache[expandoId];
          element[domExpandoAttr] = void 0;
        }
      }
    }
  };
});
