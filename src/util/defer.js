// Generated by CoffeeScript 1.6.2
define(['dom/browser'], function(browser) {
  var nextTaskid, postMessageHandler, tasks;

  if (window.setImmediate) {
    return setImmediate;
  }
  if (browser.msie < 9) {
    return setTimeout;
  }
  nextTaskid = 0;
  tasks = {};
  postMessageHandler = function(event) {
    if (tasks[event = event.data]) {
      tasks[event]();
      delete tasks[event];
    }
  };
  if (window.attachEvent) {
    attachEvent('onmessage', postMessageHandler);
  } else {
    window.addEventListener('message', postMessageHandler);
  }
  return function(cb) {
    var taskid;

    tasks[taskid = nextTaskid++] = cb;
    postMessage(taskid, '*');
  };
});

/*
//@ sourceMappingURL=defer.map
*/
